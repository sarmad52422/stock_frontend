"use strict";(self.webpackChunkstocky_web=self.webpackChunkstocky_web||[]).push([[358],{8358:($t,P,s)=>{s.r(P),s.d(P,{AuthenticationModule:()=>Wt});var H=s(3213),S=s(1597),m=s(5861),t=s(4650),x=s(9646),J=s(8746),K=s(4782),V=s(7417),Z=s(8040),w=s(6493),W=s(2340),X=s(529);let f=(()=>{class e{constructor(n){this.http=n,this.url=W.N.api.baseUrl+"/auth/account"}search(n){return this.http.post(`${this.url}/search`,n,{observe:"response"})}updateAccountExpiryDate(n,o){return this.http.put(`${this.url}/update-expiry-date/${n}`,{expiryDate:o},{observe:"response"})}updateAccountRole(n,o){return this.http.put(`${this.url}/update-role/${n}`,{roles:o},{observe:"response"})}updateAccountPassword(n,o){return this.http.put(`${this.url}/update-password/${n}`,{password:o},{observe:"response"})}toggleStatus(n){return this.http.put(`${this.url}/toggle-status/${n}`,{},{observe:"response"})}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(X.eN))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var $=s(5258),M=s(9651),z=s(7375),g=s(6895),h=s(433),B=s(8244),u=s(3679),r=s(6704),j=s(5635),R=s(8231),k=s(1971),tt=s(4284),nt=s(2834),et=s(8807),ot=s(9597);function at(e,c){if(1&e&&(t.ynx(0),t._UZ(1,"nz-alert",1),t.BQk()),2&e){const n=t.oxw();let o;t.xp6(1),t.Q6J("nzCloseable",n.closeable)("nzMessage",null!==(o=n.message)&&void 0!==o?o:"No message provided")("nzType",n.type)}}let ct=(()=>{class e{constructor(){this.showAlert=!1,this.type="info",this.closeable=!0}showNotification(n){this.message=n,this.showAlert=!0,setTimeout(()=>{this.showAlert=!1},1e4)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-page-alert"]],inputs:{showAlert:"showAlert",message:"message",type:"type",closeable:"closeable"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"mb4",3,"nzCloseable","nzMessage","nzType"]],template:function(n,o){1&n&&t.YNc(0,at,2,3,"ng-container",0),2&n&&t.Q6J("ngIf",o.showAlert)},dependencies:[g.O5,ot.r],encapsulation:2}),e})();var it=s(6600),T=s(387),st=s(6709),lt=s(3282),rt=s(6793),pt=s(26),N=s(7542),C=s(7044),D=s(3325),L=s(9562),ut=s(4055),y=s(6616),v=s(1811),b=s(6497),p=s(5156),E=s(4897);function dt(e,c){if(1&e){const n=t.EpF();t.ynx(0)(1),t.TgZ(2,"nz-row",3)(3,"nz-col",4)(4,"nz-form-item",5)(5,"nz-form-label"),t._uU(6,"Current Expiry Date"),t.qZA(),t.TgZ(7,"span",6),t._uU(8),t.ALo(9,"date"),t.qZA()()(),t.TgZ(10,"nz-col",4)(11,"nz-form-item")(12,"nz-form-label"),t._uU(13,"New Expiry Date"),t.qZA(),t.TgZ(14,"app-date-picker",7),t.NdJ("selectChange",function(a){t.CHM(n);const i=t.oxw();return t.KtG(i.expiryDate=a)}),t.qZA()()()(),t.BQk()()}if(2&e){const n=t.oxw();t.xp6(2),t.Q6J("nzGutter",16),t.xp6(1),t.Q6J("nzSpan",24),t.xp6(5),t.Oqu(t.lcZ(9,5,null==n.account?null:n.account.expiryDate)),t.xp6(2),t.Q6J("nzSpan",24),t.xp6(4),t.Q6J("select",n.expiryDate)}}function mt(e,c){if(1&e){const n=t.EpF();t.TgZ(0,"div")(1,"button",8),t.NdJ("click",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.handleClose())}),t._uU(2,"Cancel"),t.qZA(),t.TgZ(3,"button",9),t.NdJ("nzOnCancel",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.emptyAction())})("nzOnConfirm",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.handleUpdate())}),t._uU(4,"Submit "),t.qZA()()}if(2&e){const n=t.oxw();t.xp6(3),t.Q6J("nzLoading",n.isLoading)}}let O=(()=>{class e{constructor(n,o,a){var i=this;this.accountUsecase=n,this.util=o,this.notification=a,this.close=new t.vpe,this.visibility=!1,this.isLoading=!1,this.expiryDate="",this.handleUpdate=(0,m.Z)(function*(){if(i.account?.expiryDate&&i.account?.userId&&i.expiryDate){const l=i.accountUsecase.updateAccountExpiryDate(i.account.userId,i.expiryDate);yield i.util.handleUsecaseRequest(l,i.notification)}}),this.handleClose=()=>{this.visibility=!1,this.close.emit(!0)},this.emptyAction=()=>{}}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(f),t.Y36(z.f),t.Y36(T.zb))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-account-update-expiry-date"]],inputs:{account:"account",visibility:"visibility"},outputs:{close:"close"},decls:3,vars:1,consts:[["nzCentered","","nzTitle","Update Account Expiry Date",3,"nzVisible","nzOnCancel","nzVisibleChange"],[4,"nzModalContent"],[4,"nzModalFooter"],[3,"nzGutter"],[3,"nzSpan"],[1,"items-center"],[1,"b"],[3,"select","selectChange"],["nz-button","","nzType","default",3,"click"],["nz-button","","nz-popconfirm","","nzPopconfirmPlacement","top","nzPopconfirmTitle","Are you sure?","nzType","primary",3,"nzLoading","nzOnCancel","nzOnConfirm"]],template:function(n,o){1&n&&(t.TgZ(0,"nz-modal",0),t.NdJ("nzOnCancel",function(){return o.handleClose()})("nzVisibleChange",function(i){return o.visibility=i}),t.YNc(1,dt,15,7,"ng-container",1),t.YNc(2,mt,5,1,"div",2),t.qZA()),2&n&&t.Q6J("nzVisible",o.visibility)},dependencies:[u.t3,u.SK,r.Nx,r.iK,y.ix,C.w,v.dQ,b.JW,p.du,p.Uh,p.Hf,E.L,g.uU],encapsulation:2}),e})();var _t=s(7607);const gt=function(){return[]},ht=function(){return{}};function ft(e,c){if(1&e){const n=t.EpF();t.ynx(0)(1),t.TgZ(2,"nz-row",3)(3,"nz-col",4)(4,"nz-form-item",5)(5,"nz-form-label"),t._uU(6,"Current Role"),t.qZA(),t._UZ(7,"app-user-roles",6),t.qZA()(),t.TgZ(8,"nz-col",4)(9,"nz-form-item")(10,"nz-form-label"),t._uU(11,"Select Roles"),t.qZA(),t.TgZ(12,"app-company-role-search-dropdown",7),t.NdJ("valueChange",function(a){t.CHM(n);const i=t.oxw();return t.KtG(i.roles=a)}),t.qZA()()()(),t.BQk()()}if(2&e){const n=t.oxw();let o;t.xp6(2),t.Q6J("nzGutter",16),t.xp6(1),t.Q6J("nzSpan",24),t.xp6(4),t.Q6J("roles",null!==(o=null==n.account?null:n.account.roles)&&void 0!==o?o:t.DdM(6,gt)),t.xp6(1),t.Q6J("nzSpan",24),t.xp6(4),t.Q6J("value",n.roles)("props",t.DdM(7,ht))}}function zt(e,c){if(1&e){const n=t.EpF();t.TgZ(0,"div")(1,"button",8),t.NdJ("click",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.handleClose())}),t._uU(2,"Cancel"),t.qZA(),t.TgZ(3,"button",9),t.NdJ("nzOnCancel",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.emptyAction())})("nzOnConfirm",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.handleUpdate())}),t._uU(4,"Submit "),t.qZA()()}if(2&e){const n=t.oxw();t.xp6(3),t.Q6J("nzLoading",n.isLoading)}}let Q=(()=>{class e{constructor(n,o,a){var i=this;this.accountUsecase=n,this.util=o,this.notification=a,this.close=new t.vpe,this.visibility=!1,this.isLoading=!1,this.roles=[],this.handleUpdate=(0,m.Z)(function*(){if(i.account&&i.account.userId&&i.roles){const l=i.account.userId,d=i.roles.map(A=>new w.D3(A.id)),_=i.accountUsecase.updateAccountRole(l,d);yield i.util.handleUsecaseRequest(_,i.notification)}}),this.handleClose=()=>{this.close.emit(!0)},this.emptyAction=()=>{}}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(f),t.Y36(z.f),t.Y36(T.zb))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-account-update-role"]],inputs:{account:"account",visibility:"visibility"},outputs:{close:"close"},decls:3,vars:1,consts:[["nzCentered","","nzTitle","Update Role",3,"nzVisible","nzOnCancel","nzVisibleChange"],[4,"nzModalContent"],[4,"nzModalFooter"],[3,"nzGutter"],[3,"nzSpan"],[1,"items-center"],[3,"roles"],["mode","multiple",1,"w-100",3,"value","props","valueChange"],["nz-button","","nzType","default",3,"click"],["nz-button","","nz-popconfirm","","nzPopconfirmPlacement","top","nzPopconfirmTitle","Are you sure?","nzType","primary",3,"nzLoading","nzOnCancel","nzOnConfirm"]],template:function(n,o){1&n&&(t.TgZ(0,"nz-modal",0),t.NdJ("nzOnCancel",function(){return o.handleClose()})("nzVisibleChange",function(i){return o.visibility=i}),t.YNc(1,ft,13,8,"ng-container",1),t.YNc(2,zt,5,1,"div",2),t.qZA()),2&n&&t.Q6J("nzVisible",o.visibility)},dependencies:[u.t3,u.SK,r.Nx,r.iK,y.ix,C.w,v.dQ,b.JW,p.du,p.Uh,p.Hf,N.t,_t.F],encapsulation:2}),e})();var Ct=s(8114);function At(e,c){if(1&e){const n=t.EpF();t.ynx(0)(1),t.TgZ(2,"nz-row",3)(3,"nz-col",4)(4,"nz-form-item")(5,"nz-form-label"),t._uU(6,"New Password"),t.qZA(),t.TgZ(7,"nz-form-control")(8,"app-password-input",5),t.NdJ("valueChange",function(a){t.CHM(n);const i=t.oxw();return t.KtG(i.password=a)}),t.qZA()()()(),t.TgZ(9,"nz-col",4)(10,"nz-form-item")(11,"nz-form-label"),t._uU(12,"Confirm Password"),t.qZA(),t.TgZ(13,"nz-form-control")(14,"app-password-input",5),t.NdJ("valueChange",function(a){t.CHM(n);const i=t.oxw();return t.KtG(i.confirmPassword=a)}),t.qZA()()()()(),t.BQk()()}if(2&e){const n=t.oxw();t.xp6(2),t.Q6J("nzGutter",16),t.xp6(1),t.Q6J("nzSpan",24),t.xp6(5),t.Q6J("value",n.password),t.xp6(1),t.Q6J("nzSpan",24),t.xp6(5),t.Q6J("value",n.confirmPassword)}}function Tt(e,c){if(1&e){const n=t.EpF();t.TgZ(0,"div")(1,"button",6),t.NdJ("click",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.handleClose())}),t._uU(2,"Cancel"),t.qZA(),t.TgZ(3,"button",7),t.NdJ("nzOnCancel",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.emptyAction())})("nzOnConfirm",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.handleUpdate())}),t._uU(4,"Submit "),t.qZA()()}if(2&e){const n=t.oxw();t.xp6(3),t.Q6J("nzLoading",n.isLoading)}}let q=(()=>{class e{constructor(n,o,a,i){var l=this;this.accountUsecase=n,this.notification=o,this.msg=a,this.util=i,this.close=new t.vpe,this.visibility=!1,this.isLoading=!1,this.password="",this.confirmPassword="",this.handleUpdate=(0,m.Z)(function*(){if(l.account&&l.account.userId&&l.isPasswordMatch()){l.isLoading=!0;const d=l.accountUsecase.updateAccountPassword(l.account.userId,l.password);yield l.util.handleUsecaseRequest(d,l.notification),l.isLoading=!1}}),this.handleClose=()=>{this.close.emit(!0)},this.emptyAction=()=>{}}isPasswordMatch(){if(this.password.length>3){const o=this.password==this.confirmPassword;return o||this.msg.error("Password and confirm password do not match"),o}return this.msg.error("Password must be greater than 3 characters"),!1}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(f),t.Y36(T.zb),t.Y36(M.dD),t.Y36(z.f))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-account-update-password"]],inputs:{account:"account",visibility:"visibility"},outputs:{close:"close"},decls:3,vars:1,consts:[["nzCentered","","nzTitle","Reset Password",3,"nzVisible","nzOnCancel","nzVisibleChange"],[4,"nzModalContent"],[4,"nzModalFooter"],[3,"nzGutter"],[3,"nzSpan"],[3,"value","valueChange"],["nz-button","","nzType","default",3,"click"],["nz-button","","nz-popconfirm","","nzPopconfirmPlacement","top","nzPopconfirmTitle","Are you sure?","nzType","primary",3,"nzLoading","nzOnCancel","nzOnConfirm"]],template:function(n,o){1&n&&(t.TgZ(0,"nz-modal",0),t.NdJ("nzOnCancel",function(){return o.handleClose()})("nzVisibleChange",function(i){return o.visibility=i}),t.YNc(1,At,15,5,"ng-container",1),t.YNc(2,Tt,5,1,"div",2),t.qZA()),2&n&&t.Q6J("nzVisible",o.visibility)},dependencies:[u.t3,u.SK,r.Nx,r.iK,r.Fd,y.ix,C.w,v.dQ,b.JW,p.du,p.Uh,p.Hf,Ct.C],encapsulation:2}),e})();var U=(()=>{return(e=U||(U={}))[e.UPDATE_EXPIRY=0]="UPDATE_EXPIRY",e[e.UPDATE_PASSWORD=1]="UPDATE_PASSWORD",e[e.UPDATE_ROLE=2]="UPDATE_ROLE",e[e.UPDATE_STATUS=3]="UPDATE_STATUS",U;var e})();let Y=(()=>{class e{constructor(){this.ModalType=U}toggleModalVisibility(n){this.activeModal=n}resetActiveModal(){this.activeModal=void 0}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-account-update-icon"]],inputs:{account:"account"},decls:13,vars:7,consts:[["icon","edit","nz-dropdown","","nzPlacement","topLeft","nzTrigger","click","text","","type","default",3,"nzDropdownMenu"],["menu","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",3,"click"],[3,"account","visibility","close"]],template:function(n,o){if(1&n&&(t._UZ(0,"app-icon-button",0),t.TgZ(1,"nz-dropdown-menu",null,1)(3,"ul",2)(4,"li",3),t.NdJ("click",function(){return o.toggleModalVisibility(o.ModalType.UPDATE_EXPIRY)}),t._uU(5,"Update Expiry Date"),t.qZA(),t.TgZ(6,"li",3),t.NdJ("click",function(){return o.toggleModalVisibility(o.ModalType.UPDATE_ROLE)}),t._uU(7,"Update Role"),t.qZA(),t.TgZ(8,"li",3),t.NdJ("click",function(){return o.toggleModalVisibility(o.ModalType.UPDATE_PASSWORD)}),t._uU(9,"Reset Password"),t.qZA()()(),t.TgZ(10,"app-account-update-expiry-date",4),t.NdJ("close",function(){return o.resetActiveModal()}),t.qZA(),t.TgZ(11,"app-account-update-role",4),t.NdJ("close",function(){return o.resetActiveModal()}),t.qZA(),t.TgZ(12,"app-account-update-password",4),t.NdJ("close",function(){return o.resetActiveModal()}),t.qZA()),2&n){const a=t.MAs(2);t.Q6J("nzDropdownMenu",a),t.xp6(10),t.Q6J("account",o.account)("visibility",o.activeModal===o.ModalType.UPDATE_EXPIRY),t.xp6(1),t.Q6J("account",o.account)("visibility",o.activeModal===o.ModalType.UPDATE_ROLE),t.xp6(1),t.Q6J("account",o.account)("visibility",o.activeModal===o.ModalType.UPDATE_PASSWORD)}},dependencies:[C.w,D.wO,D.r9,L.cm,L.RR,ut.r,O,Q,q],encapsulation:2}),e})();function yt(e,c){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const n=t.oxw().item;t.xp6(1),t.Oqu(n.name)}}function vt(e,c){if(1&e&&(t._UZ(0,"app-table-item",8),t.YNc(1,yt,2,1,"ng-template",null,9,t.W1O)),2&e){const n=t.MAs(2);t.Q6J("content",n)}}function bt(e,c){1&e&&t._UZ(0,"app-table-item",8),2&e&&t.Q6J("content",c.item.username)}function Ut(e,c){1&e&&t._UZ(0,"app-table-item",8),2&e&&t.Q6J("content",c.item.phone)}function xt(e,c){1&e&&t._UZ(0,"app-user-roles",10),2&e&&t.Q6J("roles",c.item.roles)}function Zt(e,c){1&e&&t._UZ(0,"app-record-status-badge",11),2&e&&t.Q6J("status",c.item.isActiveStatus)}function wt(e,c){1&e&&(t._UZ(0,"app-table-item",8),t.ALo(1,"date")),2&e&&t.s9C("content",t.lcZ(1,1,c.item.expiryDate))}const Pt=function(e){return[e]},St=function(e,c,n,o){return{saveEditHandler:e,cancelEditHandler:c,toggleEditHandler:n,confirmToggleStatusHandler:o}};function Jt(e,c){if(1&e&&(t.TgZ(0,"div",12),t._UZ(1,"app-account-update-icon",13)(2,"app-update-delete-action",14),t.qZA()),2&e){const n=c.item,o=t.oxw();t.xp6(1),t.Q6J("account",n),t.xp6(1),t.Q6J("buttons",t.VKq(4,Pt,o.TableButtonEnum.TOGGLE_STATUS))("item",n)("props",t.l5B(6,St,o.emptyAction,o.emptyAction,o.emptyAction,o.handleStatusUpdate))}}const Mt=function(e){return{showPagination:!0,isLoading:e,tableLayout:"auto",tableSize:"default"}},Rt=function(e,c,n,o,a,i,l){return[e,c,n,o,a,i,l]};let F=(()=>{class e{constructor(n,o,a){var i=this;this.accountUsecase=n,this.notification=o,this.util=a,this.pageRequestChange=new t.vpe,this.pageRequest=new Z.k,this.isLoadingTable=!1,this.tableCols=[{title:"",width:5},{title:"Name"},{title:"Username"},{title:"Phone"},{title:"Role"},{title:"Status"},{title:"Exp. Date"}],this.TableButtonEnum=it.T9,this.onCancel=()=>{},this.emptyAction=(0,m.Z)(function*(){}),this.handleStatusUpdate=function(){var l=(0,m.Z)(function*(d){const _=i.accountUsecase.toggleStatus(d);yield i.util.handleUsecaseRequest(_,i.notification)});return function(d){return l.apply(this,arguments)}}()}onPageSizeChange(n){this.pageRequest.pageSize=n,this.handlePageSizeChange().then()}onPageIndexChange(n){this.pageRequest.pageNumber=n,this.handlePageSizeChange().then()}handlePageSizeChange(){var n=this;return(0,m.Z)(function*(){n.pageRequestChange.emit(n.pageRequest)})()}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(f),t.Y36(T.zb),t.Y36(z.f))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-account-table-list"]],inputs:{pageRequest:"pageRequest",tableData:"tableData",isLoadingTable:"isLoadingTable"},outputs:{pageRequestChange:"pageRequestChange"},decls:15,vars:16,consts:[[3,"pageIndex","pageSize","colHeadings","dataList","props","rowTemplates","pageIndexChange","pageSizeChange"],["fullNameTmpl",""],["emailTmpl",""],["phoneTmpl",""],["roleTmpl",""],["statusTmpl",""],["expDateTmpl",""],["actionTmpl",""],[3,"content"],["nameConcat",""],[3,"roles"],[3,"status"],[1,"fl"],[3,"account"],[3,"buttons","item","props"]],template:function(n,o){if(1&n&&(t.TgZ(0,"app-table",0),t.NdJ("pageIndexChange",function(i){return o.onPageIndexChange(i)})("pageSizeChange",function(i){return o.onPageSizeChange(i)})("pageIndexChange",function(i){return o.pageRequest.pageNumber=i})("pageSizeChange",function(i){return o.pageRequest.pageSize=i}),t.qZA(),t.YNc(1,vt,3,1,"ng-template",null,1,t.W1O),t.YNc(3,bt,1,1,"ng-template",null,2,t.W1O),t.YNc(5,Ut,1,1,"ng-template",null,3,t.W1O),t.YNc(7,xt,1,1,"ng-template",null,4,t.W1O),t.YNc(9,Zt,1,1,"ng-template",null,5,t.W1O),t.YNc(11,wt,2,3,"ng-template",null,6,t.W1O),t.YNc(13,Jt,3,11,"ng-template",null,7,t.W1O)),2&n){const a=t.MAs(2),i=t.MAs(4),l=t.MAs(6),d=t.MAs(8),_=t.MAs(10),A=t.MAs(12),Xt=t.MAs(14);t.Q6J("pageIndex",o.pageRequest.pageNumber)("pageSize",o.pageRequest.pageSize)("colHeadings",o.tableCols)("dataList",o.tableData)("props",t.VKq(6,Mt,o.isLoadingTable))("rowTemplates",t.Hh0(8,Rt,Xt,a,i,l,d,_,A))}},dependencies:[st.a,lt.Z,rt.b,pt.x,N.t,Y,g.uU],encapsulation:2}),e})();const Nt=["pageAlertComponent"],Dt=["alertContent"];function Lt(e,c){if(1&e&&t._UZ(0,"app-breadcrumbs",4),2&e){const n=t.oxw();t.Q6J("crumbs",n.crumbs)}}function Et(e,c){if(1&e&&(t.ynx(0),t._UZ(1,"nz-option",23),t.BQk()),2&e){const n=c.$implicit;t.xp6(1),t.s9C("nzLabel",n.name),t.Q6J("nzValue",n)}}function Ot(e,c){if(1&e&&(t.ynx(0),t.YNc(1,Et,2,2,"ng-container",22),t.BQk()),2&e){const n=c.ngIf;t.xp6(1),t.Q6J("ngForOf",n)}}function Qt(e,c){1&e&&(t.TgZ(0,"p"),t._uU(1," Search for an account by providing any one of the following; "),t.qZA(),t.TgZ(2,"ul")(3,"li"),t._uU(4,"Name"),t.qZA(),t.TgZ(5,"li"),t._uU(6,"Phone number"),t.qZA(),t.TgZ(7,"li"),t._uU(8,"Email or Username"),t.qZA(),t.TgZ(9,"li"),t._uU(10,"Select one role"),t.qZA()())}const qt=function(){return[8,8]},Yt=function(e,c,n){return{onSearchAction:e,isLoadingSearchResult:!1,onResetAction:c,onCancelAction:n}};function Ft(e,c){if(1&e){const n=t.EpF();t.TgZ(0,"form",5),t._UZ(1,"app-page-alert",null,6),t.TgZ(3,"div",7)(4,"div",8)(5,"div",9)(6,"div",10)(7,"nz-form-item")(8,"div",11),t._UZ(9,"app-hint",12),t.TgZ(10,"nz-form-label"),t._uU(11,"Enter name"),t.qZA()(),t.TgZ(12,"input",13),t.NdJ("ngModelChange",function(a){t.CHM(n);const i=t.oxw();return t.KtG(i.searchPayload.employeeFullName=a)}),t.qZA()()(),t.TgZ(13,"div",10)(14,"nz-form-item")(15,"div",11),t._UZ(16,"app-hint",14),t.TgZ(17,"nz-form-label"),t._uU(18,"Enter Phone number"),t.qZA()(),t.TgZ(19,"input",13),t.NdJ("ngModelChange",function(a){t.CHM(n);const i=t.oxw();return t.KtG(i.searchPayload.employeePhoneNumber=a)}),t.qZA()()(),t.TgZ(20,"div",10)(21,"nz-form-item")(22,"div",11),t._UZ(23,"app-hint",15),t.TgZ(24,"nz-form-label"),t._uU(25,"Enter Email"),t.qZA()(),t.TgZ(26,"input",13),t.NdJ("ngModelChange",function(a){t.CHM(n);const i=t.oxw();return t.KtG(i.searchPayload.employeeEmail=a)}),t.qZA()()(),t.TgZ(27,"div",10)(28,"nz-form-item")(29,"div",11)(30,"nz-form-label"),t._uU(31,"Search by role"),t.qZA()(),t.TgZ(32,"nz-select",16,17),t.NdJ("ngModelChange",function(a){t.CHM(n);const i=t.oxw();return t.KtG(i.searchPayload.role=a)}),t.YNc(34,Ot,2,1,"ng-container",18),t.ALo(35,"async"),t.qZA()()()()()(),t.TgZ(36,"div",8)(37,"div",19)(38,"div",10),t._UZ(39,"app-search-reset-button",20),t.qZA()()(),t.YNc(40,Qt,11,0,"ng-template",null,21,t.W1O),t.qZA()}if(2&e){const n=t.oxw();t.xp6(3),t.Q6J("nzGutter",t.DdM(27,qt)),t.xp6(3),t.Q6J("nzLg",8)("nzSpan",8)("nzXs",24),t.xp6(6),t.Q6J("ngModel",n.searchPayload.employeeFullName),t.xp6(1),t.Q6J("nzLg",8)("nzSpan",8)("nzXs",24),t.xp6(6),t.Q6J("ngModel",n.searchPayload.employeePhoneNumber),t.xp6(1),t.Q6J("nzLg",8)("nzSpan",8)("nzXs",24),t.xp6(6),t.Q6J("ngModel",n.searchPayload.employeeEmail),t.xp6(1),t.Q6J("nzLg",8)("nzSpan",8)("nzXs",24),t.xp6(5),t.Q6J("ngModel",n.searchPayload.role)("nzAllowClear",!0)("nzDisabled",n.isFetchingRoles)("nzLoading",n.isFetchingRoles),t.xp6(2),t.Q6J("ngIf",t.lcZ(35,25,n.roles$)),t.xp6(4),t.Q6J("nzLg",12)("nzSpan",12)("nzXs",10),t.xp6(1),t.Q6J("props",t.kEZ(28,Yt,n.handleSearch,n.handleReset,n.noAction))}}let G=(()=>{class e{constructor(n,o,a,i){var l=this;this.accountUsecase=n,this.roleUsecase=o,this.messageService=a,this.util=i,this.resultChange=new t.vpe,this.crumbs=V.Ai,this.isFetchingRoles=!1,this.searchPayload=new w.F8,this.pageRequest=new Z.k,this.tableData=(0,x.of)([]),this.loadingData=!1,this.noAction=()=>{},this.handleSearch=(0,m.Z)(function*(){if(!l.searchPayload.hasAtLeastOneAccountProps())return void l.showErrorNotification();const d={searchRequest:l.searchPayload,page:l.pageRequest};l.loadingData=!0;let _=l.accountUsecase.search(d).pipe((0,J.x)(()=>{l.loadingData=!1})),A=yield l.util.handleUsecaseRequest(_,l.messageService);yield l.handleSearchResult(A)}),this.handleReset=()=>{this.clearTable(),this.clearTable()}}ngOnInit(){this.handleGetRoles()}handlePageChange(n){var o=this;return(0,m.Z)(function*(){o.pageRequest=n,yield o.handleSearch()})()}showErrorNotification(){this.pageAlert&&(this.pageAlert.type="warning",this.pageAlert.showNotification(this.alertContent))}handleGetRoles(){this.isFetchingRoles=!0,this.roles$=this.roleUsecase.getAll().pipe((0,J.x)(()=>{this.isFetchingRoles=!1}),(0,K.d)())}handleSearchResult(n){var o=this;return(0,m.Z)(function*(){n.ok&&(o.resultChange.emit(n.body),n.body&&n.body.result&&n.body.page&&(o.pageRequest=n.body.page,o.tableData=(0,x.of)(n.body.result)))})()}clearForm(){this.searchPayload=new w.F8,this.pageRequest=new Z.k}clearTable(){this.tableData=(0,x.of)([])}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(f),t.Y36($.V),t.Y36(M.dD),t.Y36(z.f))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-account"]],viewQuery:function(n,o){if(1&n&&(t.Gf(Nt,5),t.Gf(Dt,5,t.Rgc)),2&n){let a;t.iGM(a=t.CRH())&&(o.pageAlert=a.first),t.iGM(a=t.CRH())&&(o.alertContent=a.first)}},outputs:{resultChange:"resultChange"},decls:8,vars:5,consts:[["title","Manage Account",3,"breadcrumb","content"],["breadCrumbs",""],["content",""],[3,"isLoadingTable","pageRequest","tableData","pageRequestChange"],[3,"crumbs"],["autocomplete","off","nz-form","","nzLayout","vertical",1,"ph-main"],["pageAlertComponent",""],["nz-row","",3,"nzGutter"],["nz-col","","nzSpan","24"],["nz-row","","nzGutter","10"],["nz-col","",3,"nzLg","nzSpan","nzXs"],[1,"flex","flex-row"],["content","Enter the full name to search"],["name","searchTerm","nz-input","","placeholder","Enter search parameter here","type","text",3,"ngModel","ngModelChange"],["content","Search with phone number"],["content","Search with email address or username"],["name","role","nzPlaceHolder","Select role ..",3,"ngModel","nzAllowClear","nzDisabled","nzLoading","ngModelChange"],["roleSelectDropdown",""],[4,"ngIf"],["nz-row","","nzJustify","space-between"],[3,"props"],["alertContent",""],[4,"ngFor","ngForOf"],[3,"nzValue","nzLabel"]],template:function(n,o){if(1&n&&(t.TgZ(0,"page-header",0),t.YNc(1,Lt,1,1,"ng-template",null,1,t.W1O),t.YNc(3,Ft,42,32,"ng-template",null,2,t.W1O),t.qZA(),t.TgZ(5,"nz-card"),t.ynx(6),t.TgZ(7,"app-account-table-list",3),t.NdJ("pageRequestChange",function(i){return o.handlePageChange(i)}),t.qZA(),t.BQk(),t.qZA()),2&n){const a=t.MAs(2),i=t.MAs(4);t.Q6J("breadcrumb",a)("content",i),t.xp6(7),t.Q6J("isLoadingTable",o.loadingData)("pageRequest",o.pageRequest)("tableData",o.tableData)}},dependencies:[g.sg,g.O5,h._Y,h.Fj,h.JJ,h.JL,h.On,h.F,B.q,u.t3,u.SK,r.Lr,r.Nx,r.iK,j.Zp,R.Ip,R.Vq,k.bd,tt.O,nt.n,et.M,ct,F,g.Ov],encapsulation:2}),e})();var I=s(9132);const Kt=[{path:"account",component:G,data:{title:"Account"}}];let Vt=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[I.Bz.forChild(Kt),I.Bz]}),e})(),Wt=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[Vt,H.m8,S.CompanyModule,S.CompanyModule]}),e})()}}]);